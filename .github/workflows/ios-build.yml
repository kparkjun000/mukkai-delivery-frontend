- name: Build iOS app (Archive Only)
  run: |
    cd ios/App
    xcodebuild -workspace App.xcworkspace \
               -scheme App \
               -configuration Release \
               -destination generic/platform=iOS \
               -archivePath App.xcarchive \
               CODE_SIGN_IDENTITY="" \
               CODE_SIGNING_REQUIRED=NO \
               CODE_SIGNING_ALLOWED=NO \
               archive

- name: Create IPA Manually (No Export)
  run: |
    cd ios/App
    
    echo "📦 Archive 내용 확인:"
    ls -la App.xcarchive/Products/Applications/
    
    echo "🔨 수동 IPA 생성 시작..."
    
    # Payload 폴더 생성
    mkdir -p Payload
    
    # App 파일을 Payload로 복사
    cp -r App.xcarchive/Products/Applications/App.app Payload/
    
    # IPA 파일 생성 (ZIP 압축)
    zip -r App-unsigned.ipa Payload/
    
    echo "✅ 무서명 IPA 생성 완료!"
    ls -lh *.ipa

- name: Verify IPA Contents
  run: |
    cd ios/App
    echo "📋 생성된 IPA 파일 정보:"
    file App-unsigned.ipa
    unzip -l App-unsigned.ipa | head -20

# Export 단계 완전히 제거
# - name: Export IPA (Development)

# Upload 단계도 임시 제거  
# - name: Upload to App Store Connect
