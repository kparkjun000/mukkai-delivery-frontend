<!DOCTYPE html>
<html>
<head>
    <title>회원가입 테스트</title>
</head>
<body>
    <h1>회원가입 테스트</h1>
    
    <form id="registerForm">
        <div>
            <label>이름: <input type="text" id="name" value="테스트유저"></label>
        </div>
        <div>
            <label>이메일: <input type="email" id="email" value="test@example.com"></label>
        </div>
        <div>
            <label>비밀번호: <input type="password" id="password" value="test1234"></label>
        </div>
        <div>
            <label>주소: <input type="text" id="address" value="서울시 강남구"></label>
        </div>
        <button type="submit">회원가입 테스트</button>
    </form>

    <div id="result"></div>

    <script>
        document.getElementById('registerForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const address = document.getElementById('address').value;
            
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<p>테스트 중...</p>';
            
            // 6가지 형식 시도
            const formats = [
                // 형식 1: 기본
                {
                    name: name,
                    email: email,
                    address: address,
                    password: password
                },
                // 형식 2: user 접두사
                {
                    userName: name,
                    userEmail: email,
                    userAddress: address, 
                    userPassword: password
                },
                // 형식 3: snake_case
                {
                    user_name: name,
                    user_email: email,
                    user_address: address,
                    user_password: password
                },
                // 형식 4: userRegisterRequest wrapper
                {
                    userRegisterRequest: {
                        name: name,
                        email: email,
                        address: address,
                        password: password
                    }
                },
                // 형식 5: request wrapper
                {
                    request: {
                        name: name,
                        email: email,
                        address: address,
                        password: password
                    }
                },
                // 형식 6: 대소문자 다른 형식
                {
                    Name: name,
                    Email: email,
                    Address: address,
                    Password: password
                }
            ];
            
            for (let i = 0; i < formats.length; i++) {
                try {
                    console.log(`형식 ${i + 1} 시도:`, formats[i]);
                    resultDiv.innerHTML += `<p>형식 ${i + 1} 시도 중...</p>`;
                    
                    const response = await fetch('/open-api/user/register', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(formats[i])
                    });
                    
                    const data = await response.json();
                    console.log(`형식 ${i + 1} 응답:`, response.status, data);
                    
                    if (response.ok && data.result && data.result.result_code === 0) {
                        resultDiv.innerHTML += `<p style="color: green;">✅ 성공! 형식 ${i + 1}이 작동합니다!</p>`;
                        resultDiv.innerHTML += `<pre>${JSON.stringify(data, null, 2)}</pre>`;
                        return;
                    } else {
                        resultDiv.innerHTML += `<p style="color: orange;">형식 ${i + 1} 실패: ${response.status} - ${data.result?.result_message || 'Unknown error'}</p>`;
                    }
                    
                } catch (error) {
                    console.error(`형식 ${i + 1} 에러:`, error);
                    resultDiv.innerHTML += `<p style="color: red;">형식 ${i + 1} 에러: ${error.message}</p>`;
                }
            }
            
            resultDiv.innerHTML += '<p style="color: red;">❌ 모든 형식 실패</p>';
        });
    </script>
</body>
</html>